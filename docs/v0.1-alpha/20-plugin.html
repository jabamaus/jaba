<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
  <head>
    <title>20-plugin</title>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap">
    <link rel="stylesheet" href="../mamd.css">
  </head>
<body>
<h2>20-plugin</h2>

<p><sub><sup>This page applies to v0.1-alpha<br></sup></sub>
<a href="../index.html">home</a> &gt; <a href="index.html">0.1-alpha home</a></p>

<pre><code class="ruby">text :example do
  content %Q{Add a block of raw text using ruby&#39;s %Q string literal notation.
Makes it easy to write formatted text including newlines
}
  line &#39;Add a line explicitly&#39;
end
</code></pre>

<pre><code class="ruby">type :text do

  title &#39;Basic text file that is written to HDD&#39;

  attr :filename, type: :file do
    title &#39;Path of the filename to be generated&#39;
    basedir_spec :definition_root
    default do
      &quot;#{id}.txt&quot;
    end
  end

  attr :content, type: :to_s do
    title &#39;Content as a single multiline string&#39;
    note &#39;Directly set content of file as a string.&#39;
  end

  attr_array :line, type: :to_s do
    title &#39;Adds a line of content to file&#39;
    flags :allow_dupes, :no_sort
  end

  attr :eol, type: :choice do
    title &#39;End of line style&#39;
    items [:lf, :crlf, :native]
    default :native
  end

  plugin :text do
    def generate
      services.nodes.each do |n|
        attrs = n.attrs
        file = services.new_file(attrs.filename, eol: attrs.eol, capacity: 1024)
        w = file.writer
        c = attrs.content
        w.write_raw(c) if c
        lines = attrs.line
        if !lines.empty?
          w &lt;&lt; &quot;#{lines.join(&quot;\n&quot;)}&quot;
        end
        file.write
      end
    end

    def build_output(root)
      services.nodes.each do |n|
        root[:filename] = n.attrs.filename
      end
    end
  end
end
</code></pre>

<p><sub><sup>Generated on 05-Sep-23 by <a href="https://github.com/vmg/redcarpet">Redcarpet</a> using <a href="https://github.com/alecthomas/chroma">Chroma</a>, <a href="https://rsms.me/inter">Inter</a> and <a href="https://github.com/tonsky/FiraCode">FiraCode</a>. css by Harry Denholm</sup></sub></p>
</body>
</html>
